/* Phase 1 - states/fullscreen.css
   全屏状态覆盖：:fullscreen / :-webkit-full-screen 以及“移动端横屏全屏”相关基础规则
   注意：仅放“全屏相关”样式，避免与 views/ 与 base/ 重叠。 */

.guixu-root-container:fullscreen,
.guixu-root-container:-webkit-full-screen {
  width: 100vw;
  height: 100vh;
  max-width: none;
  margin: 0;
  border-radius: 0;
  /* 防止全屏下固定/浮层被父容器裁剪（iPad/Safari 常见） */
  overflow: visible;
}
.guixu-root-container:fullscreen .game-container,
.guixu-root-container:-webkit-full-screen .game-container {
  height: 100%;
}

/* 移动端横屏全屏：固定底部栏，防止被正文遮挡 */
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .bottom-status {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0; /* 使用视口底部 */
  z-index: 10010;
  width: 100vw;
  max-width: 100vw;
  box-sizing: border-box;
  padding: 6px 12px calc(6px + env(safe-area-inset-bottom, 0));
  gap: 10px;
  background: linear-gradient(90deg,
      rgba(45, 27, 61, 0.9) 0%,
      rgba(26, 26, 46, 0.92) 50%,
      rgba(45, 27, 61, 0.9) 100%);
  border-top: 1px solid #c9aa71;
  min-height: 60px;
  display: flex;                 /* 全屏横屏下改为 Flex，以便居中主轴 */
  /* 横屏下水平布局 */
  flex-direction: row;
  justify-content: center;       /* 居中一组控件（状态一览 + 快速发送区） */
  align-items: center;
}
/* 为正文区预留底部栏高度，防止覆盖 */
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .game-container {
  padding-bottom: calc(68px + env(safe-area-inset-bottom, 0));
}
/* 横屏下快速发送区域横向排列且宽度合理 */
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .quick-send-container {
  display: flex !important;       /* 覆盖 JS 注入的 grid，横屏全屏改为 Flex */
  flex-direction: row;
  align-items: center;
  gap: 10px;
  width: auto;
  margin: 0 auto;                 /* 将整个输入组居中 */
}
/* 横屏全屏下：刷新/重掷两键并排显示（不再使用移动端窗口模式的两列网格） */
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .quick-send-container .qs-left.qs-left--two-btn {
  display: flex !important;
  flex-wrap: nowrap;              /* 禁止换行，保持两键一行 */
  gap: 10px;                      /* 增大两键间距 */
}
/* 横屏全屏：两侧容器不参与收缩，中心输入区可伸缩 */
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .quick-send-container .qs-left,
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .quick-send-container .qs-right {
  flex: 0 0 auto;
  width: auto !important;        /* 覆盖移动端窗口模式下的 100% 宽 */
}
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .quick-send-container .qs-center {
  flex: 1 1 0%;                  /* 允许更积极地收缩 */
  min-width: 0;                  /* 避免内容强撑，保证左右按钮不被压 */
  width: auto !important;        /* 避免被 100% 强制撑满 */
}
/* 横屏全屏：刷新/重掷设置最小宽度，防止被压得过窄 */
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .quick-send-container .qs-left.qs-left--two-btn > #btn-first-run-refresh,
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .quick-send-container .qs-left.qs-left--two-btn > #btn-reroll-last {
  flex: 0 0 auto;
  width: auto !important;        /* 覆盖移动端窗口模式的 100% 宽 */
  min-width: 96px;               /* 控制最小尺寸，避免拥挤 */
  height: 32px;                  /* 降低高度，避免显得过大 */
  padding: 0 10px;
  font-size: 12px;
  white-space: nowrap;           /* 禁止按钮内文字换行 */
  box-sizing: border-box;
}
/* 横屏全屏：发送按钮也给出最小宽度，避免被压缩 */
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .quick-send-container .qs-right #btn-quick-send {
  flex: 0 0 auto;
  width: auto !important;        /* 覆盖移动端窗口模式的 100% 宽 */
  min-width: 92px;
  height: 32px;                  /* 与两侧按钮一致的高度 */
  padding: 0 12px;
  font-size: 12px;
  box-sizing: border-box;
}
.guixu-root-container.mobile-view.mobile-landscape-fullscreen .quick-send-input {
  width: 100%;                                /* 宽度跟随中心容器 */
  max-width: clamp(200px, 40vw, 480px);       /* 进一步收敛，给两侧按钮留空间 */
  height: 32px;                               
}
/* 左侧“状态一览”按钮：脱离主轴，贴左固定（不影响输入组几何居中） */
.guixu-root-container.mobile-view.mobile-landscape-fullscreen #btn-status-pop {
  position: absolute;
  left: max(12px, env(safe-area-inset-left, 0));
  top: 50%;
  transform: translateY(-50%);
  margin: 0;
  z-index: 10011; /* 高于底栏背景，低于浮层 */
}
/* 安全区（打孔屏/曲面屏）适配 */
@supports (padding: max(0px)) {
  .guixu-root-container.mobile-view.mobile-landscape-fullscreen .bottom-status {
    padding-left: max(12px, env(safe-area-inset-left, 0));
    padding-right: max(12px, env(safe-area-inset-right, 0));
  }
}

/* 全屏下部分模态回归桌面尺寸（示例：存档与指令中心），避免移动端样式在横屏时显得过大 */
.guixu-root-container:fullscreen.mobile-view #save-load-modal .modal-content,
.guixu-root-container:-webkit-full-screen.mobile-view #save-load-modal .modal-content,
.guixu-root-container:fullscreen.mobile-view #command-center-modal .modal-content,
.guixu-root-container:-webkit-full-screen.mobile-view #command-center-modal .modal-content {
  width: 90%;
  max-width: 800px;
  height: 90%;
  max-height: 550px;
}
.guixu-root-container:fullscreen.mobile-view #save-load-modal .modal-body,
.guixu-root-container:-webkit-full-screen.mobile-view #save-load-modal .modal-body {
  overflow-y: auto;
}
.guixu-root-container:fullscreen.mobile-view #save-load-modal .save-slot-actions > button,
.guixu-root-container:-webkit-full-screen.mobile-view #save-load-modal .save-slot-actions > button,
.guixu-root-container:fullscreen.mobile-view #save-load-modal .slot-actions > button,
.guixu-root-container:-webkit-full-screen.mobile-view #save-load-modal .slot-actions > button,
.guixu-root-container:fullscreen.mobile-view #save-load-modal .interaction-btn,
.guixu-root-container:-webkit-full-screen.mobile-view #save-load-modal .interaction-btn,
.guixu-root-container:fullscreen.mobile-view #save-load-modal .clear-saves-btn,
.guixu-root-container:-webkit-full-screen.mobile-view #save-load-modal .clear-saves-btn {
  height: 32px !important;
  padding: 0 12px !important;
  font-size: 12px !important;
  min-width: 0;
  box-sizing: border-box;
}
.guixu-root-container:fullscreen.mobile-view #save-load-modal .save-slot,
.guixu-root-container:-webkit-full-screen.mobile-view #save-load-modal .save-slot {
  gap: 10px;
}

/* 全屏下角色/功能侧栏浮层定位修正，确保最上层且不被裁剪 */
.guixu-root-container:fullscreen.mobile-view.show-character-panel .character-panel,
.guixu-root-container:-webkit-full-screen.mobile-view.show-character-panel .character-panel {
  display: block !important;
  position: fixed !important;
  z-index: 10050 !important;
  left: 50% !important;
  top: 50% !important;
  transform: translate(-50%, -50%) !important;
}
.guixu-root-container:fullscreen.mobile-view.show-interaction-panel .interaction-panel,
.guixu-root-container:-webkit-full-screen.mobile-view.show-interaction-panel .interaction-panel {
  position: fixed !important;
  z-index: 10050 !important;
  left: 50% !important;
  top: 50% !important;
  transform: translate(-50%, -50%) !important;
}
