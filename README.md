# GuiXu (归墟) - 一款专为 SillyTavern 设计的前端交互卡

**归墟** 是一款为 [SillyTavern](https://github.com/SillyTavern/SillyTavern) 打造的沉浸式前端交互界面卡。它通过系统化的面板交互与现代化的 UI/UX 设计，致力于在桌面和移动端提供稳定、流畅且高度自定义的叙事体验。

---

## **归墟拼好卡**

## ✨ 主要更新

### 1. **UI/UX 全面革新**
- **界面重构**: 桌面端将核心信息整合至主界面，移动端采用悬浮菜单并支持横屏，显著提升信息可视化与操作便捷性。
- **风格统一与自定义**: 所有面板（背包、人物关系等）视觉风格统一，并新增“设置中心”，支持自定义背景、字体，提供一键全屏、思维链折叠、流式输出等功能。

### 2. **系统深化与智能管理**
- **关系与背包升级**: “人物关系”与“背包”面板功能重构，新增搜索、标签分组，并直观显示物品数量与价值。
- **自动化角色管理**: 新增自动化角色提取功能，可将 NPC 信息快速写入世界书，并支持自定义提取规则。

### 3. **更生动的世界交互**
- **NPC 维度扩展**: NPC 拥有独立的基础属性、天赋、灵根、装备系统等深度模块，NPC将更加丰满生动立体。
- **新增交易系统**: 开放功能完善的交易系统，引入价格保护与 NPC 拒绝机制。

### 4. **世界书优化与新增**
- **新增更多参考体系**: 为方便世界观构建，新增了多个核心体系的参考模板。
- **基础系统世界书优化**: 对其他现有的基础系统世界书进行了新的优化和调整，提升了游玩的沉浸感。

### 5. **前端渲染优化**
- 强化了前端的渲染稳定性，确保AI生成的内容都能被完美解析并呈现，杜绝任何多余文本或代码的意外泄漏。

### 6. **新增变量编辑器**
- 现在你可以方便地对游戏进程中的数据进行实时查看与修改。

---

## ✨ 重要注意事项

### 1. **首次导入（必做）**
第一次导入本卡，请务必先**清理酒馆的浏览器缓存**，以确保所有新内容和功能正常加载。

### 2. **渲染器设置（必查）**
务必确保酒馆助手内的 **“启用渲染器”** 与 **“启用代码折叠”** 两个选项均已开启。

### 3. **加载与刷新（必读）**
- 开新档时界面空白，请先点击 **“一键刷新”** 按钮。

### 4. **网络要求**
系统脚本通过 **JsDelivr** 加载，请务必保持良好的网络连接，否则可能导致功能异常。

### 5. **存档管理**
- **开启新档**：您可以通过修改“读写序号”或使用“**一键清除所有存档**”功能来开始一个全新的游戏。
- **读档异常**：读取存档后若发现数据遗漏（如装备、物品），请尝试重新读取一遍该存档。

---

## 🚀 升级指南

### 1. **首次升级操作（必做）**
导入新版本后，请务必先 **删除旧版世界书**，然后 **清理浏览器缓存**，以避免冲突和加载错误。

### 2. **旧存档迁移（如有需要）**
若希望保留旧存档，请严格遵循以下步骤：
- **第一步：备份数据**：在旧版本中，先**保存并导出**你的存档文件。然后，打开 **“归墟（拼好卡）**” 世界书，搜索词条 **“本世历程”**，并完整**复制**其中的内容。
- **第二步：恢复存档**：在新版本的开局界面，通过 **“存档管理”** 功能**导入**你刚刚备份的存档文件。
- **第三步：恢复历程**：成功读档后，再次打开 **“归墟（拼好卡）”** 世界书，将第一步复制的内容**粘贴**回 **“本世历程”** 词条中。

### 3. **重要兼容性提醒**
请注意，**本版本暂不支持直接将【归墟梦星5.0版本】的存档导入使用**。如需游玩“归墟拼好卡”，务必**重新开新档**。

---

## 🔧 常见问题排查

### 1. **问题：UI渲染错乱？**
- **排查**：请尝试点击右上角小铅笔，检查 `UpdateVariable` 标签是否存在。

### 2. **问题：正文出现变量代码等无关内容？**
- **排查**：使用编辑功能（小铅笔）检查，确保正文被 `gametxt` 标签完整包裹。若问题依旧，请优先尝试手动删除思维链里的所有内容。

### 3. **问题：正文没有行动选项按钮？**
- **排查**：请同样检查并确保该选项被 `action` 标签正确包裹。若无效，处理方法同上。

### 4. **问题：LLM输出的标签一直掉格式？**
- **排查**：检查您的预设，看看是否关闭了CoT（思维链）部分的所有内容。

### 5. **问题：点击一键刷新后卡死？**
- **排查**：建议重装一下浏览器，或者换个浏览器（建议谷歌浏览器）。这可能是某些缓存出现了bug，始终无法被正常清除。如还是不行，只能建议您重装一下酒馆了。

### 6. **问题：开局一直失败？**
- **排查**：检查是不是天赋背景设置的过于复杂，导致生成的token过多（截断），建议天赋最好不要超过7个，要不哈基米很大可能中途就截断了

---

## 🙏 鸣谢

- **原作者**: @梦星 ([原贴地址](https://discord.com/channels/1134557553011998840/1395002325751300227))
- **二次修订**: @stone
- **特别感谢：**
    * 来自 **@zzyxpoly** 的1.81世界书整合
    * 来自 **@CrHouse** 的约束（npc反应，宏大概念，判定约束）
    * 来自 **@Tanhuax** 的古典仙道指导文风
    * 来自 **@七七七.小七** 的现实基调+抒情美好文风
    * 来自 **@Sycamore** 的数值参考借鉴
    * 来自 **@孑孓** 的开局前端
    * 来自 **@ove** 的经济体制借鉴
---

## 📜 开源协议

本项目基于 **MIT License** 开源。详情请见 [LICENSE](./LICENSE) 文件。

Copyright (c) 2025 slot
